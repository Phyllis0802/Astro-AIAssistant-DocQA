理
2
数据预处理
上一步符合数据检
查的光谱
波段数据完
备的拼接光
谱
将同源的
GU 、
GV、GI 的一维无缝
光谱沿波长方向拼
接
114
3
点源一维谱
的
PCAZ
分类与红移
测量
第二步产生的点源
光谱
点源光谱分
类结果：恒
星，类星
体，星系，
其它；红移
值与误差
点源光谱分类与红
移测量
4
展源一维谱
的
星
系
PCAZ 分类
与红移测量
第二步产生的展源
光谱
展源光谱红
移值与误差
展源光谱星系红移
值与误差
8.1.4.47 无缝光谱红移优化测量工作包
该工作包针对粗分类与红移测量工作包分类为星系与类星体的
光谱进行红移优化测量。如图2，工作包输入：粗分类为星系与类
星体的1D 光谱，进行光谱预处理与谱线检测，根据检测结果，对
于检测出谱线的光谱，进行谱线拟合与谱线红移测量，输出：谱线
红移与误差为该光谱的优化红移测量结果；对于未能检测出谱线的
光谱，以测光红移为先验，结合测光数据进行光谱SED 匹配，输出：
匹配出的SED 红移值与误差做为优化红移测量结果。工作包流程图
及模块分解见图10.77（工作包编号：KSC-SJ2-PK-18），模块列表
和功能详见表10.50。
数据预处理
（滤波、定标等）
多色成像出来的形态轮廓
（Prof i l e_1D
）
无缝光谱探测器轮廓
（PSF_1D）
一维光谱对应的光谱粗
分类与红移测量的星表
谱线红移的优化测量值
( Z-l i nes)
谱线检测（GA
L| Q
SO
）
是否有线
谱线红移优化测量
SED-测光红移测量
Y
SED红移测量值
（Z_SED
）
N
光谱模板库和线表配置
文件
一维光谱
图10.77 无缝光谱红移优化测量工作包流程图
表10.50 无缝光谱红移优化测量工作包模块列表
序号
功能模块名
称
输入
输出
实现功能
1
数据预处理
1）粗分类为星系类
星体的一维光谱星表
2）粗分类为星系类
星体的GU、GV、
GI 一维无缝光谱
3）探测器在光谱目
标源波长方向上
拼接光谱
将同源的
GU 、
GV、GI 的一维无缝
光谱沿波长方向拼
接
115
psf_1d
4）光谱目标源波长
方向上profile_1d
5 ）星系光谱模板
库，发射线星系星表
2
谱线检测
上一步产生的光谱
谱线检测结
果
将粗分类为星系类
星体的光谱进行谱
线检测
3
有谱线的一
维谱的红移
优化测量
第二步检测到谱线的
光谱
谱线红移值
与误差
对有谱线的光谱进
行谱线拟合与测
量，通过谱线红移
确定优化红移结果
与误差。
4
没有检测到
谱线的一维
谱SED 红
移优化测量
第二步没有检测到谱
线的光谱
SED 红移
值与误差
对没有检测到谱线
的光谱以测光红移
为先验，结合测光
数据进行SED 红移
与误差计算。
8.1.4.48 无缝光谱发射线星系谱线测量工作包
该工作包主要负责发射线星系谱线测量工作，输入发射线星系
红移和一维光谱以及星系发射线线表，然后进行发射线星系谱线测
量得到发射线测量星表,并作为2 级数据存入数据库中。该工作包流
程图及模块分解见图10.78（工作包编号：KSC-SJ2-PK-19），模块
列表和功能详见表10.51。
发射线星系谱线测量
发射线测量星表
（Li ne_f l ux、
Li ne_EW
、Li ne_FW
H
M
）
发射线星系红移
一维光谱
星系发射线线表
图10.78 发射线星系谱线测量工作包流程图
表10.51 发射线星系谱线测量工作包模块列表
功能模块
名称
输入
输出
实现功能
发射线星系
谱线测量
1）发射线星系红移
2）一维光谱
3）星系发射线线表
发射线测量星表
测量发射线
星系谱线
116
8.1.4.49 无缝光谱恒星参数测量工作包
该工作包是针对2 级数据-恒星1D 无缝光谱，结合多色测光星
表信息，对一维无缝光谱进行恒星参数测量。详细过程如下：首先
输入1D 光谱做数据质量检测和预处理，通过卷积神经网络初步估
计恒星大气参数作为模板匹配测量的初始值，随后通过模板匹配理
论光谱获得恒星大气参数等信息。该工作包流程图及模块分解见图
10.79（工作包编号：KSC-SJ2-PK-20），模块列表和功能详见表
10.52。
粗分类恒星星表
CN
N方法预估计恒星参数
恒星参数初值
模板匹配
恒星参数星表（Tef f 、
l ogg、[ Fe/ H
] 、[ a/ Fe]
等
一维光谱
一维PSF轮廓
恒星理论模板光谱库配置文
件
图像预处理：
光谱拼接
图10.79 恒星参数测量工作包流程图
表10.52 参数星表测量工作包模块列表
序号
功能模块名
称
输入
输出
实现功能
1
数据预处
理：光谱拼
接
1）粗分类恒星星表
2）GU、GV、GI 的一
维无缝光谱
3）无缝光谱PSF
拼接光谱
将同源的
GU 、GV 、
GI 的一维无
缝光谱沿波
长方向拼接
2
神经网络预
估计
上一步产生的光谱
神经网络的恒星
参数初值(有效
温度、表面重
力、金属丰度和
α丰度)
预估无缝光
谱的参数初
值
3
模板匹配
无缝光谱拼接产生的光
谱
神经网络预估计产生的
恒星参数(有效
温度、表面重
力、金属丰度和
α丰度)和相应
模板匹配得
到最佳匹配
模板的恒星
参数及误差
117
恒星参数初值
3）恒星理论光谱配置
文件
的误差
8.1.4.50 无缝光谱高精度波长定标工作包
该工作包针对仪器效应改正后的光谱图像进行分析。首先，该
工作包针对1 级无缝光谱数据，利用海量外部巡天数据开展高精度
波长定标。高精度波长定标详细过程如下：首先收集速度标准星表
并生成全波段模版谱，收集发射线点源表；然后计算速度标准星不
同波长范围速度及误差，计算不同发射线速度及误差；其次比较测
量速度与预期速度的差异，修正初始波长定标关系；最后，利用修
正后的波长定标关系，更新所有目标波长。该工作包流程图及模块
分解见图10.80（工作包编号：KSC-SJ2-PK-21），模块列表和功能
详见表10.53。
已有光谱巡天数据
收集速度标准星表并
生成全波段模板谱
收集发射线电源表
速度标准星星表
发射线天体发射线表
CSST一维光谱
计算速度标准星速度
及误差
计算不同发射线速度
及误差
不同波长范围内的速
度及误差
不同发射线速度及误
差
修正初始波长
定标关系
更新目标波长
高精度波长定标
光谱 
图10.80 高精度波长定标工作包流程图
表10.53 高精度波长定标工工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
收集速度标准星
表并生成全波段
模板谱模块
已有公开的光
谱巡天数据
速度标准星表
收集速度标准星表
并生成全波段模版
谱
2
收集发射线电源
表模块
已有公开的光
谱巡天数据
发射线天体发射
线表
收集发射线点源表
3
计算速度标准星
速度及误差模块
CSST 一维光
谱
不同波长范围内
的速度及误差
计算速度标准星不
同波长范围速度及
误差
4
计算不同发射线
速度及误差模块
CSST 一维光
谱
不同发射线速度
及误差
计算不同发射线速
度及误差
5
修正初始波长定
标关系模块
Get_RV_stars,
Get_RV_emiss
ion_line 输出
修正后的波长定
标关系
修正初始波长定标
关系
118
结果，及目标
0 级像位置
6
更新目标波长模
块
CSST 一维光
谱
波长修正后的
CSST 一维光谱
更新所有目标波长
8.1.4.51 无缝光谱高精度流量定标工作包