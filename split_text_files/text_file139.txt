5
1 级
无缝光谱1 级数据
可用性标记检查1
QC1:保证1 级数据的可用性、准确
性。检测对象是入库的二维光谱科学
数据
6
2 级
一维光谱科学数据生
成
抽取一维光谱，并经过流量和波长定
标得到一维光谱科学数据
7
2 级
无缝光谱1 级数据
可用性标记检查2
保证1 级数据的可用性、准确性，检
测对象是生成的一维光谱科学数据。
8
2 级
无缝光谱星表数据生
成
主要负责星表生成，包括星系分类，
红移测量，天体类型以及恒星星表参
数（恒星大气参数、视向速度、距离
和消光）等。
9
2 级
高精度波长和流量定
标的星表生成
得到高精度波长流量定标的星表
8.1.3 主要流水线
为实现10.1.2 节巡天模块各项功能，根据巡天模块观测设备的
43
数据结构和数据流水线需求，以及输入和输出数据的内容，把整个
巡天模块设备的数据处理流水线设计分为0 级、1 级和2 级处理流
水线，巡天模块整体流水线见图10.3，巡天模块主要流水线列表见
表10.5。
44
Q
C0
图像评估
单幅图像处理流水线
密集星场
处理流水
线
近邻大星
系处理流
水线
星云处理
流水线
   
数据产品生成流水线
（2级处理流水线）
合
并
星
表
流
水
线
PSF
均
匀
化
流
水
线
合
并
图
像
数
据
流
水
线
星
系
红
移
流
水
线
天测高
精度单
帧图像
相对定
位流水
线
强引
力透
镜源
表生
成流
水线
恒星
星表
参数
生成
流水
线
太阳系
快速移
动天体
源表和
轨道参
数生成
流水线
                         图像评估流水线
                         （0级处理流水线）
近邻可分
解星系处
理流水线
低密度单帧图像天体测量初步处理流水线
中等密度单帧图像天体测量初步处理流水线
高密度单帧图像天体测量初步处理流水线
是否存在天区
重复覆盖
是
太阳系快速移动天
体检测识别流水线
天测5
参数
计算
流水
线
星系团处
理流水线
饱和污染
图像处理
流水线
无缝光谱图像
无缝光谱初步处理
流水线
Q
C1
无缝光谱精确
处理流水线
伪直接成像
流水线
星表生成流水线
基于正向建
模的一维光
谱抽取流水
线
基于目标源
的一维光谱
处理流水线
天区观测覆盖分析
Q
C2
数据库
（0级数据）
数据库
（1级数据）
数据库
（2级数据）
多色图像0级处理流水线
无缝光谱
0级处理流水线
Q
C0
I
I I
天
区
标
志
1. 低密度天区
2. 中密度天区
3. 高密度天区
1. 近邻可
分解星系
2. 近邻
大星系
3. 星
云区
4. 已知
星系团
5. 饱和污
染图像
1级处理流水线
I 3
I 3+I I 1
I I 2
I I 3
I I 4
I I 5
I 1
I 3
I 2
0. 正常
天区
I I 0
多色
成像
2+级
流水
线
（科
学团
队）
无缝光谱2+级流水
线（科学团队）
高精
度流
量定
标流
水线
图10.3 巡天模块数据处理总流水线图
45
巡天模块0 级处理流水线：首先将运控中心下传的0 级数据图
像作为输入，经过数据类型判断后，如果为多色成像数据的图像将
进行多色成像0 级数据图像可用性标记，然后对多色成像0 级数据
图像进行图像评估，根据多测成像和天测数据处理对于图像的不同
要求，对不同的成像图像进行分类，称为多色成像0 级数据处理流
水线；如果为无缝光谱数据的图像将进行无缝光谱0 级数据图像可
用性标记，然后对无缝光谱0 级数据图像进行图像评估，对不同的
图像进行分类，成为无缝光谱0 级数据处理流水线；最后将完成图
像评估的数据入库，共包含2 条次级流水线。
巡天模块1 级处理流水线：巡天模块0 级处理流水线输出的不
同类型的图像作为1 级处理流水线的输入。1 级流水线按日常处理
流水线和特殊图像处理流水线划分。1 级流水线根据功能不同划分
为3 种类型：多色成像1 级数据处理流水线，共包含7 条流水线；
天体测量1 级数据处理流水线，共包含4 条流水线；无缝光谱1 级
处理流水线，共包含3 条流水线。然后经过QC1，生成1 级科学
图像和相关数据存入1 级数据库。一共包含14 条1 级流水线。
巡天模块2 级处理流水线：巡天模块2 级处理流水线将读取1
级处理流水线的结果作为输入，最后输出数据产品。2 级处理流水
线划分为3 种类型的处理流水线：多色成像2 级数据处理流水线，
共包含7 条流水线；天体测量2 级数据处理流水线，共包含3 条流
水线；无缝光谱2 级处理流水线，共包含4 条流水线，生成各类数
据产品，然后经过QC2 得到2 级科学数据，作为2 级科学数据产
品存入数据库供科学用户使用。一共包含14 条2 级流水线。
巡天模块0 级、1 级和2 级处理流水线总由共31 条分支流水
线组成，主要流水线列表和对应的流水线编号详见表10.5 。
表10.5 巡天模块主要流水线列表
总流水线
次级流水线
分支流水线
流水线编号
巡天模块
0 级处理
流水线
多色成像图像评估
流水线
多色成像图像评估流
水线
KSC-SJ1-PL0-01
无缝光谱图像评估
流水线
无缝光谱图像评估流
水线
KSC-SJ2-PL0-01
巡天模块
1 级处理
流水线
多色成像正常图像
数据处理日常流水
线
单幅图像处理流水线
KSC-SJ1-PL1-01
多色成像特殊图像
密集星场处理流水线
KSC-SJ1-PL1-02
46
数据处理日常流水
线
近邻可分解星系处理
流水线
KSC-SJ1-PL1-03
近邻大星系处理流水
线
KSC-SJ1-PL1-04
星云处理流水线
KSC-SJ1-PL1-05
星系团处理流水线
KSC-SJ1-PL1-06
饱和污染处理流水线
KSC-SJ1-PL1-07
天体测量正常图像
数据处理日常流水
线
中等密度星场天体测
量初处理流水线
KSC-SJ9-PL1-01
天体测量特殊图像
数据处理日常流水
线
低密度星场天体测量
初处理流水线
KSC-SJ9-PL1-02
高密度星场天体测量
初处理流水线
KSC-SJ9-PL1-03
太阳系快速移动天
体检测识别流水线
太阳系快速移动天体
检测识别流水线
KSC-SJ9-PL1-04
无缝光谱图像数据
处理日常流水线
无缝光谱初步处理流
水线
KSC-SJ2-PL1-01
伪直接成像流水线
KSC-SJ2-PL1-02
无缝光谱精确处理流
水线
KSC-SJ2-PL1-03
巡天模块
2 级处理
总流水线
多色成像数据产品
生成流水线
合并星表流水线
KSC-SJ1-PL2-01
PSF 均匀化流水线
KSC-SJ1-PL2-02
合并图像数据流水线
KSC-SJ1-PL2-03
星系红移流水线
KSC-SJ1-PL2-04
强引力透镜源表生成
流水线
KSC-SJ1-PL2-05
恒星星表参数生成流
水线
KSC-SJ1-PL2-06
高精度流量定标流水
线
KSC-SJ1-PL2-07
多色成像2 +级流水
线（科学团队）
KSC-SJ1-PL2-08
天体测量数据产品
生成流水线
天测高精度单帧图像
相对定位流水线
KSC-SJ9-PL2-01
天体测量5 参数计
算流水线
KSC-SJ9-PL2-02
太阳系快速移动天体
KSC-SJ9-PL2-03
47
8.1.3.1
巡天模块0 级处理流水线
1. 多色成像0 级处理流水线
多色成像0 级数据处理流水线类型只有多色成像图像评估流水
线。在每天的观测数据下来后，首先进行QC0 的科学可用性标记，