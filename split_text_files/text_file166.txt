1 级处理流水线
KSC-SJ8-PL1-01
太赫兹模块2 级
处理总流水线
数据质量检查与
FITS 文件生成
2 级处理流水线
KSC-SJ8-PL2-01
8.5.2.1
0 级处理流水线
0 级数据处理流水线需要实现：1.对太赫兹模块硬件产生的原始
数据进行初步标记；2.按照观测的log 文件以及观测任务文件对原
始数据进行重新组包，并加入时间戳，生成完整观测频谱0 级数据。
太赫兹模块0 级处理流程图见图10.135（流水线编号：KSC-SJ8-
PL0-01）。
176
太赫兹模块
原始数据
Q
C0
0级处理流水线
数据库
（0级数据）
数据组包
观测l og文件，
时间戳
图10.135 太赫兹模块0 级处理流程图
8.5.2.2
1 级处理流水线
1 级数据处理流水线需要实现对0 级数据的校准。根据太赫兹
模块观测模式的不同可分为单点观测和OTF 观测。单点观测是针对
点源目标进行成像，需要对成像数据的强度、频率和位置进行校准。
OTF 观测模式是针对区域目标进行观测。在太赫兹模块进行OTF
观测时，需要通过控制天线波束指向按照指定的观测路径对目标区
域内的样点逐个进行快速扫描观测。在此模式下观测数据不仅要进
行强度、频率和位置的校准，而且还需要进行网格重整来消除OTF
模式下空间采样数据的非均匀性，因此太赫兹模块1 级处理流程图
见图10.136。（流水线编号：KSC-SJ8-PL1-01）。
强度校准
频率位置校准
网格重整
单点观测模式数据处理流水线
（1级处理流水线）
O
TF观测模式数据处理流水线
（1级处理流水线）
强度校准
频率位置校准
数据库
（1级数据）
太赫兹模块
0级数据
观测模式
判断
图10.136 太赫兹模块1 级处理流程图
8.5.2.3
2 级处理流水线
2 级数据处理流水线需要实现对1 级数据的质量进行检查，将
数据中噪声异常数据或存在干扰数据进行标记，并且将校准后符合
177
数据质量要求的数据按照标准的FITS 文件定义生成标准FITS 文件。
因此，太赫兹模块2 级处理流程图见图10.137。（流水线编号：
KSC-SJ8-PL2-01）
图10.137 太赫兹模块2 级处理流程图
8.5.3 主要工作包
根据上述数据处理流水线的结构和数据流方向，可以把流水线
分解为下面9 个主要工作包单元，分别是0 级数据处理流水线包括
2 个工作包单元；1 级数据处理流水线包括4 个工作包单元；2 级数
据处理流水线包括3 个工作包单元。详见表10.109 所示。各个流水
线工作包简要叙述如下：
表10.109 太赫模块数据处理工作包
序号
工作包名称
工作包编号
1
0 级数据可用性标记工作包
KSC-SJ8-PK-01
2
0 级数据组包工作包
KSC-SJ8-PK-02
3
单点观测模式下1 级数据强度校准工
作包
KSC-SJ8-PK-03
4
单点观测模式下1 级数据频率和位置
校准工作包
KSC-SJ8-PK-04
5
OTF 观测模式下1 级数据强度校准工
作包
KSC-SJ8-PK-05
6
OTF 观测模式下1 级数据频率和位置
校准工作包
KSC-SJ8-PK-06
7
1 级数据网格重整工作包
KSC-SJ8-PK-07
8
1 数据质量检查工作包
KSC-SJ8-PK-08
9
2 级数据的FITS 文件生成工作包
KSC-SJ8-PK-09
数据质量检查
FI TS文件生成
单点观测模式数据处理流水线
（2级处理流水线）
数据库
（2级数据）
太赫兹模块
1级数据
178
8.5.3.1
0 级数据可用性标记工作包
对太赫兹硬件模块输出的原始数据进行质量检查。核查输出的
原始文件中关键字段的取值范围，若各字段取值均在预先设定的范
围内则标记0 级数据可用，反之，标记不可用。0 级数据可用性标
记工作包流程图及模块分解见图10.138（工作包编号：KSC-SJ8-
PK-01），模块列表和功能见表10.110。
太赫兹模块
原始数据
数据质量检查
0级处理可用性标记工作包
关键字段取值
是否合格
0级数据可用
合格
0级数据不可用
不合格
图10.138 太赫兹模块0 级数据可用性标记工作包
表10.110 太赫兹模块0 级数据可用性标记工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
0 级数据质量检
查
模
块
（QC0）
太赫兹模
块原始数
据
带有质量标
记的0 级数
据
对原始的0 级数据进行质
量判断，并标志合格状态
8.5.3.2
0 级数据组包工作包
将太赫兹模块频谱处理组件（硬件）产生的数据依据设定的0
级数据定义以及观测任务文件中关键字段的说明，将频谱数据拆包
存储的数据进行重新组包，并加入时间戳，生成完整观测频谱0 级
数据。0 级数据组包工作包流程图及模块分解见图10.139（工作包
编号：KSC-SJ8-PK-02），模块列表和功能见表10.111。
图10.139 太赫兹模块0 级数据组包工作包
经Q
C0后的
原始数据
数据组包
0级数据组包工作包
0级数据定义
数据库
（0级数据）
观测任务
179
表10.111 太赫兹模块0 级数据组包工作包模块列表
序号
功能模块
名称
输入
输出
实现功能
1
0 级数据
组包模块
经过
QC0
后的太赫兹
模块原始数
据
0 级数据
对经过QCO 标记过的太赫兹模
块原始数据进行重新组包，并加
入时间戳。
8.5.3.3
单点观测模式下1 级数据强度校准工作包
依据仿真和实测的不同边缘切削时的主波束宽度、不同边缘切
削时的旁瓣电平以及不同轴向偏焦（离焦）的天线增益，计算实测
的耦合参数（校准因子）对1 级数据强度进行校准。单点观测模式
下1 级数据强度校准工作包流程图及模块分解见图10.140（工作包
编号：KSC-SJ8-PK-03），模块列表和功能见表10.112。
太赫兹模块
0级数据
计算实测的校准因子
1级数据强度校准工作包
边缘切削时的
主波束宽度
强度校准后的
0级数据
边缘切削时的
旁瓣电平
离焦的
天线增益
图10.140 太赫兹模块1 级数据强度校准工作包
表10.112 太赫兹模块1 级数据强度校准工作包模块列表
序号
功能模块
名称
输入
输出
实现功能
1
1 级数据
强度校准
太赫兹
模块0
级原始
数据
强度校准后
的0 级数
据
计算实测的校准因子，实现对太赫
兹0 级数据进行强度校准，为最终
得到1 级数据的奠定基础
8.5.3.4
单点观测模式下1 级数据频率和位置校准工作包
太赫兹模块1 级频谱数据受观测者位置、地球绕太阳公转、太
阳公转、太阳在银河系中的运动等多重因素产生多普勒频移的影响，
需要统一速度扣除多普勒频移从而实现对1 级数据的频率校准。太
赫兹模块进行观测时因受到平台在轨运动、地球公转、太阳公转等
而同目标源存在相对运动，需要对1 级数据对应的位置进行校准。
单点观测模式下1 级数据频率和位置校准工作包流程图及模块分解
见图10.141（工作包编号：KSC-SJ8-PK-04），模块列表和功能见
表10.113。
180
经幅度校准后
的0级数据
1级数据频率校准
1级数据频率和位置校准工作包
多普勒频移
太赫兹模块1级
数据
1级数据位置校准
与目标源的
相对运动
图10.141 太赫兹模块1 级数据频率和位置校准工作包
表10.113 太赫兹模块1 级数据频率位置校准工作包模块列表
序号
功能模块名
称
输入
输出
实现功能
1
1 级数据频
率位置校准
经强度校准
后的太赫兹
模块0 级
数据
太赫兹模块
的1 级数据
实现对太赫兹0 级数据进行
频率和位置校准，最终得到
单点观测模式下太赫兹模块
1 级数据
8.5.3.5
OTF 观测模式下1 级数据强度校准工作包
依据仿真和实测的不同边缘切削时的主波束宽度、不同边缘切
削时的旁瓣电平以及不同轴向偏焦（离焦）的天线增益，计算实测
的耦合参数（校准因子）对1 级数据强度进行校准。OTF 观测模式
下1 级数据强度校准工作包流程图及模块分解见图10.142（工作包
编号：KSC-SJ8-PK-05），模块列表和功能见表10.114。
太赫兹模块