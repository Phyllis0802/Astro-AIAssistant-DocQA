8.3.3.22 IFS 积分光谱的吸收线测量工作包
在完成IFS 空间像素合并后，本工作包（编号：KSC-SJ6-PK-
22）首先对光谱进行吸收线拟合，拟合使用和IFS 光谱波长覆盖范
围相近的恒星光谱库。拟合得到星系的恒星运动学参数，以及等值
宽度等科学参数。该工作包的结构示意图和功能模块列表分别见图
10.124 和表10.94。
163
数据库IFS
空
间合并光谱
恒星连续谱
各吸收线等值
宽度
吸收线拟合
恒星光谱库
等值宽度测量
恒星运动学参
数
图10.124 IFS 积分光谱的吸收线测量工作包的结构示意图
表10.94 IFS 积分光谱的吸收线测量工作包的功能模块列表
序号
功能模块名称
输入
输出
实现功能
1
吸收线拟合
光谱合并后的
数据立方
恒星运动学
参数及恒星
连续谱
拟合连续谱，实现恒
星运动学相关的科学
参数提取。
2
等值宽度拟合
拟合得到的恒
星连续谱
各吸收线的
等值宽度
实现吸收线等值宽度
的科学参数提取
8.3.3.23 IFS 积分光谱的发射线测量工作包
在完成吸收线拟合后，可得到扣除恒星连续谱的纯发射线光谱，
对于发射线较强的那些光谱，纯发射线光谱拟合与发射线和吸收线
同时拟合得到的结果会更加接近。而对于那些弱发射线星系，发射
线的拟合结果依赖于信噪比以及拟合使用恒星/星族模版的准确程度。
因此本工作包（编号：KSC-SJ6-PK-23）采取2 种方式拟合发射线：
1）吸收线和发射线同时拟合；2）积分光谱扣除利用吸收线工作包
拟合得到的恒星连续谱，只留存发射线信息做拟合。通过误差分析
等方法提取可信度最高的发射线相关科学参数。该工作包的结构示
意图和功能模块列表分别见图10.125 和表10.95。
164
图10.125 IFS 积分光谱的发射线测量工作包的结构示意图
表10.95 IFS 积分光谱的发收线测量工作包的功能模块列表
序号
功能模块名称
输入
输出
实现功能
1
吸收线发射线同
时拟合
光谱合并后的
数据立方
气体发射线
相关参数结
果1
得到光谱同时拟合对
应的气体发射线测量
结果
2
发射线单独拟合
光谱合并后的
数据立方+恒
星连续谱
气体发射线
相关参数结
果2
得到纯发射线拟合对
应的气体发射线测量
结果
3
两种拟合结果可
信度对比
气体发射线结
果1 和结果
2
气体发射线
科学参数
完成气体发射线相关
科学参数的测量
8.3.3.24 IFS 积分光谱的星族分析工作包
本工作包（编号：KSC-SJ6-PK-24）针对光谱的星族成分进行
拟合分析，得到年龄、金属丰度、尘埃消光、恒星质光比等参数。
星族分析过程中将选取和CSST-IFS 光谱相匹配的星族模版库做拟
合，得到星族各参数。该工作包的结构示意图和功能模块列表分别
见图10.126 和表10.96。
数据库IFS
空
间合并光谱
气体发射线拟
合结果1
气体发射线的
科学参数
吸收线发射线
同时拟合
恒星光谱库
两种拟合结果
可信度对比
恒星连续谱
纯发射线拟合
气体发射线拟
合结果1
165
数据库IFS
空
间合并光谱
恒星形成历史
尘埃消光
光谱星族分析
星族模板库
星族年龄计算
星族金属丰度
计算
恒星质光比计
算
光度和质量加
权的年龄
光度和质量加
权的金属丰度
恒星质光比
图10.126 IFS 积分光谱的星族分析工作包的结构示意图
表10.96 IFS 积分光谱的星族分析工作包的功能模块列表
序号
功能模块名称
输入
输出
实现功能
1
星族分析
光谱合并后的
数据立方
恒星形成历
史及尘埃消
光
解析光谱的恒星形成
历史，用于计算星族
相关的科学参数，同
时得到消光参数
2
恒星年龄计算
恒星形成历史
光度和质量
加权的恒星
年龄
完成恒星年龄的测量
3
恒星金属丰度计
算
恒星形成历史
光度和质量
加权的恒星
金属丰度
完成恒星金属丰度的
测量
4
恒星质光比计算
恒星形成历史
恒星质光比
完成恒星质光比的科
学参数测量
8.3.3.25 IFS 二级数据生成工作包
在完成IFS 空间像素合并后，本工作包（编号：KSC-SJ6-PK-
25）首先对光谱进行吸收线拟合，拟合使用和IFS 光谱波长覆盖范
围相近的恒星光谱库。完成吸收线拟合后，可得到扣除恒星连续谱
的纯发射线光谱，对于发射线较强的那些光谱，纯发射线光谱拟合
与发射线和吸收线同时拟合得到的结果会更加接近。而对于那些弱
发射线星系，发射线的拟合结果依赖于信噪比以及拟合使用恒星/星
族模版的准确程度，因此本环节采用两种发射线测量方式以获取可
靠的发射线测量结果。对于星族分析，将选取和CSST-IFS 光谱相
166
匹配的星族模版库做拟合，得到星族各参数。最后，将得到的恒星
运动学参数，气体运动学参数，气体发射线流量，星族参数等数据
打包成fits，再经过质量检验和关键字索引后，存入数据库，作为
IFS 数据处理软件的标准二级数据发布。该工作包的结构示意图和功
能模块列表分别见图10.127 和表10.97。
图10.127 IFS 二级数据生成工作包的结构示意图
表10.97 IFS 合成数据空间像素合并工作包的功能模块列表
序号
功能模块名称
输入
输出
实现功能
1
吸收线特征拟合
一级合成数据
立方，恒星光
谱库
恒星运动学
参数
连续谱，吸收线特征
的测量和拟合。
2
发射线特征测量
一级合成数据
立方，吸收线
特征
发射线强度
特征，运动
学特征
不同方案下发射线强
度和运动学特征测
量。
3
星族特征测量
一级合成数据
立方，发射线
特征，星族模
板
星族特征：
年龄、金属
丰度
不同模型下星族特征
参数估计
8.4 系外行星成像星冕仪数据处理
星冕仪数据处理流水线对星冕仪0 级数据（原始观测数据）进
行处理，包括图像筛选和评估、仪器效应修正、观测效应修正等功
能。经过处理之后，得到去除仪器效应和观测效应的星冕仪1 级图
167
像数据。
8.4.1 主要功能
星冕仪数据处理软件具有5 个主要功能，详细信息见表10.98。
表10.98 星冕仪数据处理系统0-1 级功能列表
序号
主要功能
功能详解
1
数据质量检查及标记
从数据处理角度，检查0 级科学图像数据的
可用性。
2
参考图像评估和处理
对参考图像进行评估并进行处理。
3
仪器效应修正
使用参考图像对科学图像进行仪器效应改正。
4
天空背景处理
对天空背景强度进行评估
5
宇宙线标记
对科学图像中的宇宙线进行识别和标记。
6
1 级数据生成
生成星冕仪1 级数据
8.4.2 主要流水线组成
星冕仪数据处理软件0 级和1 级处理流水线总共包括4 条流水
线，其整体流水线图见图10.128 详细列表见表10.99。下面分别介
绍各个流水线。
168
0级数据图像
图像评估
正常图像
低质量图像
仪器效应改
正
数据库
（0.5级数
据）
观测效应改
正
数据库（1
级数据）
QC
0
QC
1
0级参考图像
参考图像处
理
1级参考图像
数据库（0
级数据）
0级数据图像
定标图像
图10.128 星冕仪图像数据处理整体流水线图
表10.99 星冕仪1 级流水线列表
总流水线
次级流水线
分支流水线
流水线编号
星冕仪
0
级处理总
流水线
图像评估流程
图像评估流水线
KSC-SJ7-PL0-01
图像日常处理
参考图像处理流水线
KSC-SJ7-PL0-02
仪器效应改正流水线
KSC-SJ7-PL0-03
观测效应处理流水线
KSC-SJ7-PL0-04
8.4.2.1
图像评估流水线
图像评估流水线对星冕仪数据进行成像质量评估。当星冕仪观
测数据经过QC0 并进入流水线系统后，自动触发图像评估工作包。
该工作包将依据成像质量，将图像分为正常图像和低质量图像分别
写入数据库。低质量图像的判据包括但不限于严重过曝、PSF 异常、
仪器效应或环境效应异常等。另外该流水线还将天空背景图像、天
空平场图像、参考星图像等位于SCI 文件夹中的参考数据进行标记
并写入数据库。（流水线编号：KSC-SJ7-PL0-01）
169
8.4.2.2
参考图像处理流水线
参考图像处理流水线将对本底、暗场、平场、背景等参考图像
进行合并、建模、仪器效应修正等操作，生成星冕仪1 级数据中的
参考图像数据。（流水线编号：KSC-SJ7-PL0-02）
8.4.2.3
仪器效应改正流水线
仪器效应改正流水线将利用输入的参考图像，对科学图像进行
overscan、本底校正、暗场扣除、CTE、平场校正等处理，并将结果
写入数据库。（流水线编号：KSC-SJ7-PL0-03）。
8.4.2.4
观测效应处理流水线
观测效应处理流水线对科学图像进行背景扣除和宇宙线标记等
处理。生成星冕仪1 级数据中的科学图像数据及Mask 数据（流水
线编号：KSC-SJ7-PL0-04）。
8.4.3 主要工作包
根据上述数据处理流水线的结构和数据流方向，可以把流水线
分解为图像质量评估和分类工作包、参考图像处理工作包、仪器效
应修正工作包、观测效应处理工作包、1 级数据生成工作包共5 个
工作包。详见各个流水线工作包列表10.100。按照职能划分，每个
工作包可以分解为多个工作模块，下面对每个工作包单元和分解后
的工作模块的功能进行说明。
表10.100 星冕仪工作包列表
序号
工作包名称（Package）
工作包编号
1
数据可用性标记及分类工作包
KSC-SJ7-PK-01
2
参考图像处理工作包
KSC-SJ7-PK-02
3
仪器效应改正工作包
KSC-SJ7-PK-03
4
观测效应处理工作包
KSC-SJ7-PK-04
5
1 级数据生成工作包
KSC-SJ7-PK-05
8.4.3.1
数据可用性标记及分类工作包
该工作包是针对经过QC0 判断后的数据图像和参考图像，根据
图像噪声及PSF 等信息对图像质量进行评估，识别出低质量图像；
170
通过观测记录文件对输入图像进行识别并进行标记，将本底图像、
暗场图像、平场图像、天空背景图像、科学目标图像等进行分类。
工作包流程图及模块分解见图10.129（工作包编号：KSC-SJ7-PK-
01），模块列表和功能见表10.101。
星冕仪0级数据
图像噪声评估
成像质量评估
类型判断
观测记录文件
参考图像
目标图像
天空背景
平场图像
低质量图像
低质量图像
图10.129 数据可用性标记及分类工作包
表10.101 数据可用性标记工作包模块及功能列表
序号
功能模块名称
输入
输出
实现功能
1
背景噪声判断
0 级数据图像
背景噪声判断结
果（布尔型）
0 级数据背
景质量判断
2
成像质量判断
0 级数据图像
PSF 质量判断结
果（布尔型）
0 级数据
PSF 质量判
断
3
图像类型判读
0 级数据图像
观测记录文件
分类标志
将参考图像
进行分类
8.4.3.2
参考图像处理工作包
该工作包是针对0 级参考图像，根据经过QC0 后的0 级参考
图像，对其进行合并，建模和仪器效应修正。在经过参考图像处理
工作包后，输出0.9 级参考图像工作包流程及模块分解见图10.130
（工作包编号：KSC-SJ7-PK-02），模块列表和功能见表10.102。
星冕仪参考数据
（0级）
仪器效应修正
图像合并
仪器效应建模
星冕仪参考图像
图10.130 参考图像处理工作包
171
表10.102 辅助数据挑选工作包模块及功能列表
序号
功能模块名称
输入
输出
实现功能
1
仪器效应修正
0 级参考图
像
仪器效应修
正后的参考
图像
使用dark，flat 参考图
像对背景图像进行修正
2
图像合并
仪器效应修
正后的图像
经过合并后
的参考图像
使用median 的方法对一
系列参考图像进行合并
3
仪器效应建模
经过合并后
的参考图像
经过建模后