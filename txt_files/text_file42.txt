表、零级像星表、Segmentation 图像等数据。图10.18 是无缝光谱伪
直接成像图像流水线图（流水线编号：KSC-SJ2-PL1-02）。
检查天区覆盖
覆盖的1维图像
伪直接成像生成
经过初步位置定标
后的1级二维光谱
PSF均匀化后的无缝
光谱二维图像和伪
直接成像图像，PSF
均匀化后的伪直接
成像的测光星表，
PSF均匀化后的无缝
光谱零级像初始星
表，Segm
ent at i on
图像等
数据库
（1级数据）
图10.18 无缝光谱伪直接成像图像处理流水线图
3) 无缝光谱精确处理流水线
从数据库获取经过初步位置定标后的1 级二维光谱和此次观测
的无缝光谱同时曝光的多色成像图像，进行无缝光谱精确位置定标，
更新1 级二维光谱图像，最后得到精确位置定标的二级图像并存入
数据库，为星表生成流水线做好准备。图10.19 是无缝光谱精确处
理流水线图（流水线编号：KSC-SJ2-PL1-03）。
无缝光谱对应的
伴随图像
无缝光谱精确位置定标
经过精确位置定标的二级
光谱图像
数据库
（1级数据）
经过初步位置定标后的1级
二维光谱
图10.19 无缝光谱精确处理流水线图
8.1.3.3
巡天模块2 级处理流水线
1. 多色成像2 级处理流水线
在经过1 级处理流水线的各条流水线后，得到了单次曝光图像
和星表以及特殊图像的1 级数据图像。在此基础上触发2 级处理流
水线，可以加工获得高级数据产品（1-2 级）。根据观测策略，每个
天区在每个滤光片波段会被观测至少两次（深场巡天会观测8 次以
58
上）。对单次曝光后的科学图像进行处理后，可以根据滤光片和天
区进行合并，获得更高探测深度的合并图像。在合并图像上进行星
表提取，可以探测到更多的暗弱天体，对高红移天体能获得更准确
的形态参数。我们通过不同的方法可以获得不同的数据产品并归档
存入数据库。主要包括7 条不同的流水线来实现得到各个数据产品
（2 级数据）,见图10.20。
天区覆盖表
单次曝光星表
1级图像
图像合并天区
标记表
PSF均匀化天区
标记表
天体测量1级星
表
多波段合并
多波段合并
测光星表
天体分类
天体分类星
表
恒星参数估
计
星系测光红
移测量
恒星参数星
表
星系测光红
移星表
星系测光红
移测量
星系测光红
移星表
PSF均匀化测
光
PSF均匀化测
光星表
图像合并
合并图像数
据
合并图像测
光
合并图像测
光星表
天体分类
天体分类星
表
恒星参数估
计
星系测光红
移测量
恒星参数星
表
星系测光红
移星表
天体测量参
数估计
天体测量参
数星表
天体分类
星系星表汇
总
恒星星表汇
总
恒星总表
星系总表
强透镜搜索
强透镜星表
数据库
天区观测覆盖
分析
太阳系移动
天体搜寻
太阳系移动
天体源表
太阳系移动
天体参数估
计
太阳系移动
天体星表
QC2
多色成像2+级流水
线
（科研团队）
图10.20 多色成像2 级处理总流水线图
59
1) 合并星表流水线
合并星表流水线输入是基于获得的单次曝光测光星表，对单波
段的多次观测进行合并形成单波段合并星表，最后针对多波段的数
据获得合并的信噪比更高的多波段测光星表，作为2 级数据产品存
入数据库。合并星表流水线图见图10.21（流水线编号：KSC-SJ1-
PL2-01）。
单次曝光测光星表
观测两次以上
数据库
测光星表
合并星表提取
QC2
图10.21 多色成像合并星表流水线图
2) PSF 均匀化星表流水线
PSF 均匀化星表流水线是基于单次曝光图像星表提取的另一种
方案，采用同一天区不同滤光片的星系1 级图像数据，进行多波段
PSF 均匀化分析，提取多波段测光数据，最终生成PSF 均匀化测光
星表，作为2 级数据产品存入数据库。PSF 均匀化星表流水线图见
图10.22（流水线编号：KSC-SJ1-PL-02）。
定标后的科学图像数
据何对应的wei ght 和
f l ag图像
观测两次以上
数据库
多波段PSF均匀
化星表提取
PSF均匀化测光
星表
QC2
图10.22 PSF 均匀化星表流水线图
3) 合并图像数据流水线
合并图像流水线使用同一天区相同波段（可能来自不同探测器）
的多次观测图像，进行图像合并。合并后的结果为合并图像数据文
件，相应的元数据保存到数据库中。合并图像流水线图见图10.23
（流水线编号：KSC-SJ1-PL-03）。
同一天区相同滤光片
图像（18块探测器）
观测两次以上
数据库
合并图像
合并的图像数据
文件
QC2
图10.23 合并图像数据流水线图
4) 星系红移流水线
星系红移流水线是从多波段合并星表中提取河外星系的多色信
息，通过星系红移算法生成星系红移星表，存入数据库中。星系红
60
移流水线图见图10.24（流水线编号：KSC-SJ1-PL-04）。
多波段合并测光星表
观测两次以上
数据库
星系红移计算
星系红移星表
QC2
图10.24 多色成像星系红移流水线图
5) 强引力透镜源表生成流水线
强引力透镜源表生成流水线扫描全部可用天区的所有滤光片图
像数据，证认强引力透镜事件，并形成强引力透镜数据源表，存入
数据库。强引力透镜源表生成流水线图见图10.25（流水线编号：
KSC-SJ1-PL2-05）。
所有可用天区所有滤
光片观测数据
观测两次以上
数据库
强引力透镜原
表计算
强引力透镜数据源
表
QC2
图10.25 多色成像强引力透镜源表生成流水线图
6) 恒星参数生成流水线
恒星参数生成流水线使用全部可用天区合并的测光星表（包含
7 个颜色），估计其中恒星的大气参数，生成恒星大气参数星表。
恒星参数生成流水线图见图10.26（流水线编号：KSC-SJ1-PL2-06）。
全部可用天区合并滤
光片的测光星表
观测两次以上
数据库
恒星参数计算
恒星大气参数星表
QC2
图10.26 多色成像恒星参数生成流水线图
7) 高精度流量定标流水线
高精度流量定标流水线是使用多次曝光科学图像星表和结合基
于Gaia 等巡天数据构建空间站测光系统标准星表经过高精度流量定
标得到CSST 整个测光系统的响应曲线，存入数据库。高精度流量
定标流水线见图10.27（流水线编号：KSC-SJ1-PL2-07）。
多次曝光科学图像星
表
数据库
高精度流量定标
CSST测光系统响
应曲线
61
图10.27 高精度流量定标流水线
8) 多色成像2 +级流水线（科学团队）
多色成像2 +级流水线是指科学团队在运用多色成像数据的过
程中形成的高级数据产品算法，这部分算法按数据系统预留的数据
接口接入到数据系统流水线中，成为数据系统中的一个分支流水线，
为科学家提供高级数据产品（流水线编号：KSC-SJ1-PL2-08）。
2. 天体测量2 级处理流水线
在完成了天体测量1 级流水线后启动2 级流水线，即天体测量
数据产品生成流水线。首先针对单帧图像，进行高精度相对定位。
如果同一天区重复观测超过3 次，启动天体测量五参数计算流水线。
如果同一太阳系移动天体目标的观测数据积累超过3 次，启动太阳
系移动天体定轨流水线。得到天体测量结果和太阳系移动天体定轨
数据经过QC2 后，进入数据库。然后就可以进行星表数据生成，得
到不同的科学数据产品。主要包括3 条流水线来实现得到各个数据
产品。详细介绍如下：
1) 天测高精度单帧图像相对定位流水线
在一级流水线单帧图像天体测量处理的结果的基础上，开展流
量定标，为后续星等和颜色相关的系统差的统计和处理提供准确的
星等信息。基于望远镜抖动的信息（高频、低频或突发）以及星间
弧长的变化分析望远镜设备的稳定度，针对不同的稳定程度，采用
不同的数据处理方法消除望远镜抖动带来的影响。接下来进行像质
分析、CTE 改正以及畸变修正等工作提高天体定心精度。通过形态
对目标展开目标分类识别。同时后续流程中位置系统差中与星等和
颜色相关的系统差的统计和处理工作，也最大限度的提升定位的精
度，最终精确的计算出单帧图像所有待测目标在GCRS 坐标系下的
天球坐标。单帧图像天体的天球坐标及其他相关数据经过QC2 检查
后，进入2 级数据库。天测高精度单帧图像相对定位流水线如图
10.28 所示（水线编号：KSC-SJ9-PL2-01）。
62
视场范围内参
考星提取
星表中参考
天体与图像
中观测天体
的交叉认证
基于参考天
体的全局量
度模型和参
数平差确定
待测目标初定
位
利用参考星统
计M
D
E、CD
E和
PD
E并应用到
待测目标
待测天体理想
坐标到天球坐
标的转换
天测天力参
考星表
望远镜轨道
参数数据
数据库
（2数据）
经Q
C2检查过
的单帧图像相
对定位数据
视场范围内参
考星的理想坐
标计算
视场范围内参
考星坐标系统
转换
流量定标
CTE效应校正
望远镜抖动分
析校正
畸变校正
测光参考星表
像质分析
单帧图像天体
测量粗位数据
高精度定心
待测目标分类
图10.28 天测高精度单帧图像相对定位流水线
2) 天测5 参数计算流水线
当同一观测天区存有3 张及以上的单帧观测图像高精度相对定
位数据时，启动天体测量5 参数计算流水线。首先是综合多幅单帧
图像的相对定位数据（单帧的高精度位置、初步类型标识、流量定
标过的星等和颜色），进而进行视场范围所在的局部天区的天体位
置、视差、自行等参数的归属处理，这里将充分利用较差天体测量
的优势，将选用某一参考历元的单帧图像数据为参考，进行较差归
算天体的视差和自行，进而基于巡天中不同视场的重叠区域在大天
区范围内进行整体平差，进一步降低单帧图像定位的误差对最终天
测数据结果的影响，这过程中，常规天体均按照单星处理，对于轨
道明显的双星，将启动针对双星的轨道拟合处理模块，同时解算天
体的天测5 参数和双星的轨道。同时，在完成5 参数解之后，统计
该天区内已知类星体的天测5 参数值，并对所有天体进行零点修正
实现从相对到绝对天体测量的转换。基于5 参数解检测出潜在类星
体，并给出表述。BCRS 天测数据经过QC2 检查后，进入2 级数据
库。天测5 参数计算流水线流程图见图10.29（水线编号：KSC-
SJ9-PL2-02）。
63
天测天力参考星表
对多历元相对定位数
据进行平差，以单星
模型结算天体测量5参
数
单星拟合是
否成功
BCR
S天测数据
对多历元相对定位数
据进行平差，以双星
模型结算天体测量5参
数
Q
C2
数据库
（2级）
否
相对到绝对天体
测量转换
备选类星体标识
是
仪器效应改正后单次曝光的
科学图像，m
ask图像，f l ag
图像
图10.29 天测5 参数计算流水线
3) 太阳系快速移动天体轨道确定流水线
当同一太阳系快速移动相对定位数据累计超过3 次时，利用多
历元资料进行移动天体候选体的初轨确定；基于轨道特性，启用自
主机器学习方法，提高候选体识别和运动学分类的准确率和效率。
快速移动目标的轨道计算和运行分类，形成太阳系快速移动天体历
表。经过QC2 检查后，进入2 级数据库。太阳系快速移动天体轨
道确定流水线流程图见图10.30（流水线编号：KSC-SJ9-PL2-03）。
拟合太阳系小天体
初轨
目标精确识别和轨
道运动分类
太阳系小天体历表
数据
QC2
数据库
（2级）
快速移动目标的时
序3定位数据
图10.30 太阳系快速移动天体轨道确定流水线
3. 无缝光谱2 级处理流水线
完成了0，1 级各条流水线后，就具备了触发2 级流水线的条
件，也就是无缝光谱数据产品生成流水线。首先输入波长流量工作
包准备好的波长、流量定标的参考文件，然后进行一维光谱抽谱，
得到流量和波长定标的一维光谱科学数据，进入数据库。然后就可