过内插构建PSF
5
多波段PSF 匹配
重构的PSF
全波段
PSF 均匀
化图像数
据矩阵
对全波段图像进行
PSF 均匀化操作，生
成全波段PSF 均匀
化图像数据
6
全波段联合
全波段PSF 均
全波段联
不同星场进行
86
deblending+测光
匀化图像数据矩
阵
合测光星
表
deblending 处理，开
展基于改进后的
SExtractor 的全波段
联合测光；基于改进
后的A-PHOT 的全
波段联合测光；基于
改进后的Scarlet 、
TRACTOR
、
MusCADeT
( 基于
SED) 的全波段联合
测光, 并整合多种方
法获得的星表
8.1.4.22 多色成像合并图像工作包
对两幅同一滤光片拍摄图像进行合并，输入为两次曝光的同一
天区统一滤光片1 级图像，输出为合并之后的1 级图像。多色成像
合并图像工作包流程图见图10.55（工作包编号：KSC-SJ1-PK-22），
模块列表和功能详见表10.28。
图10.55 合并图像工作包流程图
表10.28 合并图像工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
合并图像模块
为两次曝光的
同一天区同一
滤光片1 级
图像
合并之后的1
级图像
得到同一天
区同一滤光
片的合并图
像数据
天区覆盖表
1级图像数据
图像合并天
区标记表
图像合并
合并图像数
据
合并图像元
数据，用于
PSF重构
87
8.1.4.23 多色成像星系红移计算工作包
利用多色测光数据或无缝光谱数据计算星系的红移。输入为星
系的多色测光或无缝光谱数据，输出为星系红移数据。支持一批数
据的批量输入和批量输出。正常情况下将一个天区块（brick）内的
星系数据批量输入获得批量结果。多色成像星系红移计算工作包流
程图见图10.56（工作包编号：KSC-SJ1-PK-23），模块列表和功能
详见表10.29。
图10.56 多色成像星系红移计算工作包流程图
表10.29 多色成像星系红移计算工包模块列表
序号
功能模块名称
输入
输出
实现功能
1
测量星系红移模块
星系的多色测
光或无缝光谱
数据，天体分
类表
星系红移数据
得到星系红
移数据
8.1.4.24 多色成像强引力透镜源计算工作包
输入同一天区块多色图像，利用人工智能算法从中寻找强引力
透镜事件，如果找到则将主要参数保存到数据库中。多色成像强引
力透镜源计算工作包流程图见图10.57（工作包编号：KSC-SJ1-PK-
24），模块列表和功能详见表10.30。
多波段合并
测光星表
一维无缝光
谱
天体分类表
星系红移测
量
星系红移星
表
88
图10.57 多色成像强引力透镜源计算工作包流程图
表10.30 多色成像强引力透镜源计算工作包模块列表
序号
模块名称
输入
输出
实现功能
1
搜索强引力透镜模块
输入同一天区
块多色图像和
天区覆盖表
强引力透镜事件
强引力透镜
模块并保存
数据
8.1.4.25 多色成像恒星参数计算工作包
该工作包是通过输入合并星表和天体分类表，进行恒星参数测
量，得到恒星参数星表，然后经过QC2 检测存入数据库中。多色成
像恒星参数计算工作包流程图见图10.58（工作包编号：KSC-SJ1-
PK-25），模块列表和功能详见表10.31。
合并星表
恒星参数测
量
天体分类表
Q
C2
恒星参数星表
图10.58 多色成像恒星参数计算工作包流程图
表10.31 多色成像恒星参数计算工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1级图像数据
强引力透镜
搜索
强引力透镜
星表
天区覆盖表
89
1
计算恒星参数工作包
合并星表和天
体分类表
恒星参数星表
得到恒星参
数星表
8.1.4.26 多色成像高精度流量定标工作包
该工作包针对1 级多色成像数据，利用海量外部巡天数据开展
高精度流量定标。详细过程如下：首先分不同类型恒星，经精确红
化改正后，考虑恒星金属丰度、表面重力等因素影响，利用外部星
表数据构建CSST 测光系统的海量标准星表；然后利用标准星方法
和整体定标方法，对多个图像的仪器零点、恒星平场进行测量；接
着对零点随星等、颜色、探测器位置等的变化进行检验与修正；最
后进行绝对定标并确定CSST 测光系统的响应曲线。中间需要进行
多次迭代。多色成像高精度流量定标工作包流程图见图10.59（工作
包编号：KSC-SJ1-PK-08），模块列表和功能详见表10.32。
标准星方法和整体
定标方法测量图像
零点和平常
多次曝光科学图
像星表
基于Gai a等巡天数据构
建空间站测光系统标准
星表
单次曝光仪器零
点及平常改正矩
阵
单次曝光物理
星等
CSST测光系统
响应曲线
外部巡天数据检
验
高精度绝对定标
确定系统响应
曲线
地面初始响应曲
线和外部分光流
量标准星
图10.59 多色成像高精度流量定标工作包流程图
表10.32 多色成像高精度流量定标工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
标准星方法和整
体定标方法测量
图像零点和平场
1，多次曝光
科学图像星表
2，基于Gaia
等巡天数据构
建空间站测光
系统标准星表
单次曝
光仪器
零点及
平场改
正矩阵
测量多个图像的仪器零
点、恒星平场，获取仪
器零点和平场改正矩阵
2
高精度绝对定标
1，外部巡天
数据检验
2，仪器零点
和平场改正矩
阵
单次曝
光物理
星等
通过绝对定标得到物理
星等
3
确定系统响应曲
线
单次曝光物理
星等
CSST 测
光系统
得到CSST 测光系统响
应曲线
90
8.1.4.27 天测单帧图像目标检测识别工作包
根据新观测数据处理调度需求，自动触发单帧图像目标检测识
别工作包的流水线。本工作包在进行常规的图像读取解析和仪器效
应改正等图像去噪处理后，获得精细去噪后的图像、权重和标记图
像。针对密集星场和非密集星场采用不同的背景扣除和目标检测方
法。对于非密集星场，利用图像上背景所占像素远多于目标所占像
素的特点，扣除图像背景值，拟开发并使用改进后连通区域法提取
目标，实现靶面上观测图像中星象自动准确检测，该方法还可实现
多目标的自动识别（编号）及目标所占像素的计数，为开窗提取目
标提供支持，最终输出所有经去噪修正后的目标开窗提出的图像数
据。针对密集星场，拟采用密集星场背景扣除方法和目标检测方法。
单帧图像目标检测识别工作包流程图及模块分解见图10.60（工作包
编号：KSC-SJ9-PK01），模块列表和功能见表10.33。
单帧图像
文件读取
仪器效应改
正
背景扣除
目标检测
密集星场背
景扣除
密集星场目
标检测
参考图像
单帧目标开窗图像数据
及对应的权重图像和标
记图像
图10.60 天测单帧图像目标检测识别工作包流水线
表10.33 天测单帧图像目标检测识别工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
仪器效应改正
模块
0 级数据图像、单帧
平场、坏像素、单像
素特性等数据
精细去噪后的图
像、权重图像和
标记图像
单帧图像去
噪声
2
图像背景扣除
精细去噪后的图像、
背景扣除后的图
图像背景扣
地面初始响应
曲线
外部分光流量
标准星
响应曲
线
91
模块
权重图像和标记图像
像
除
3
密集星场图像
背景扣除模块
精细去噪后的图像、
权重图像和标记图像
背景扣除后的图
像
密集星场图
像背景扣除
4
图像目标检测
模块
精细去噪后的图像、
权重图像和标记图像
开窗提取出的目
标及其初步修正
后的图像数据，
记作“单帧目标
开窗图像数据”
及对应的权重图
像和标记图像
图像目标检
测
5
密集恒星图像
目标检测模块
精细去噪后的图像、
权重图像和标记图像
开窗提取出的目
标及其初步修正
后的图像数据，
记作“单帧目标
开窗图像数据”
及对应的权重图
像和标记图像
密集恒星图
像目标检测
8.1.4.28 天测单帧图像天体高精度定心工作包
根据新观测数据处理调度需求，自动触发单帧图像天体高精度
定心工作包的流水线，本工作包主要涉及三个模块，其中关键是中
心的拟合求解和修正矩计算。对于，目前有多种方法（高斯拟合、
等高轮廓法、重心、修正矩等），基于以往空间项目的经验，本项
目中我们将同时尝试使用针对空间站光学巡天设备特定点源扩散函
数（PSF）轮廓的二维椭圆高斯拟合法、二维修正矩法、EPSF 拟合
法以及重叠星像定心法。PSF 轮廓的二维高斯拟合方法较为传统，
可提供中心和星象的形状和流量等信息。常规矩方法即重心法，而
二维修正矩方法先是进行星象周边背景改正，但由于光学系统的离
散采样特性及星象底部轮廓并非严格对称（尤其是在旁边有亮源时）
造成了其对背景的测量极为敏感，为了克服这个缺点，可采用修正
矩方法，以大大减少常规矩方法对星象周围背景水平好坏的敏感。
根据空间站巡天图像的特性，合理取阈值，能够较为准确的给出其
重心位置。进而比较两种方法定心的差异，采用特点评判方法和标
准，选取最能精准测定中心的方法的结果。单帧图像天体高精度定
心工作包流程图及模块分解见图10.61（工作包编号：KSC-SJ9-
PK02），模块列表和功能见表10.34。
92
二维椭圆高
斯拟合
二维修正矩
计算
EPSF拟合
最优方法分析
重叠星像定
心
单帧目标开窗图像数据
及对应的权重图像和标
记图像
单帧图像定心量
度数据
图10.61. 单帧图像天体高精度定心工作包流水线
表10.34 单帧图像天体高精度定心工作包模块列表
序号
模块名称
输入
输出
实现功能
1
高斯拟合模块
单帧目标开窗
图像数据以及
相对应的权重
图像和标记图
像
单帧图像目标定
心量度数据
利用高斯拟
合实现单帧
图像天体高
精度定位
2
二维修正矩方法模块
单帧目标开窗
图像数据以及
相对应的权重
图像和标记图
像
单帧图像目标定
心量度数据
利用二维修
正矩方法实
现单帧图像
天体高精度
定位
3
ePSF 拟合模块
单帧目标开窗
图像数据以及
相对应的权重
图像和标记图
像
单帧图像目标定
心量度数据
利用
ePSF
拟合实现单
帧图像天体
高精度定位
93
4
重叠星像定心模块
单帧目标开窗
图像数据以及
相对应的权重
图像和标记图
像
单帧图像目标定
心量度数据
利用重叠星
像定心方法
实现单帧图
像天体高精
度定位
8.1.4.29 天测照相天体测量参考星历表编制工作包
根据空间望远镜观测数据处理需求，需要事先编制专业参考星
历表，包括一部需要包含高精度的天体测量5 参数、天体多色测光
的星等、形状分类等数据信息的星表和一部包含有太阳系大行星和
已知小天体的动力学历表。本工作包主要的工作是针对空间望远镜
的探测能力（可观测的亮度极限）、时间历元覆盖和天区覆盖情况，
搜集所有在2024 年可用的各类天测和测光星表，提取对空间望远
镜可用的信息，对所有数据进行系统统一，最终编制成系统统一、
信息完备便捷易用的星历表。照相天体测量参考星历表编制工作包
流程图及模块分解见图10.62（工作包编号：KSC-SJ9-PK-03），模
块列表和功能见表10.35。
参考系以及位置历元
的统一和转化
多波段星等数据、形
状类型数据、光变数
据的整合
太阳系行星和小天体
历表数据测处理（分
天区、时段、亮度）
统一格式的太阳系天
体各类天体的历表数
据
天测天力的参
考星表
多部天测和测光高精度
星表、太阳系天体（包
括小天体）历表
图10.62 照相天体测量参考星历表编制工作包流水线
表10.35 照相天体测量参考星历表编制工作包模块列表
序
号
模块名称
输入
输出
实现功能
1
太阳系外天体参
考历表编制模块