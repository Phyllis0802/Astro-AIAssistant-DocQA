表10.16 多色成像密集星场初步位置定标工作包流程图模块列表
完成仪器效
应改正的0. 5
级数据
密集星场目
标检测
天体的探测
器位置信
息，包含混
叠情况标记
严重混叠区
的掩码图像
密集星场混
叠分析
78
序号
功能模块名称
输入
输出
实现功能
1
密集星场初步位置定
标工作包
目标检测得到
的标记了天体
在探测器参考
系（X，Y）
中的位置的目
标星表
WCS 结构和
head 文件
得到密集星
场中天体的
初步位置信
息
8.1.4.11 前景星识别工作包
根据预先设定的星等限，选取较亮恒星，减少天体数目，确保
同外部星表交叉证认过程能够精确确认位置定标天体。该工作包的
输入为标记了天体在探测器参考系（X，Y）中的位置的目标星表的
子集，输出为只包含星等限以上的亮源构成的前景星表，同时应尽
可能避免所选前景星落在混叠区域。前景星识别工作包流程图见图
10.44（工作包编号：KSC-SJ1-PK11），模块列表和功能见表10.17。
图10.44 前景星识别工作包流程图
表10.17 前景星识别工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
前景星识别
标记了天体在探测
器参考系（X，Y）
中的位置的目标星
表的子集
只包含星等限以
上的亮源构成的
前景星表
得到前景星
位置信息
8.1.4.12 多色成像密集星场二次位置定标工作包
经过前景星识别以后，可用恒星在视场中的密度显著下降，再
次使用外部参考星表进行交叉证认，得到准确度显著提高的位置定
天体的探测
器位置信
息，包含混
叠情况标记
前景星识别
W
CS结构和
head文件
前景星位置
信息
79
标恒星星表。据此进行标准位置定标处理，实现密集星场的高精度
位置定标。该工作包的输入为初步定标的WCS 以及前景星识别工
作包输出的前景星表，输出为优化以后的高精度WCS 参数。多色
成像密集星场二次位置定标工作包流程图见图10.45（工作包编号：
KSC-SJ1-PK12），模块列表和功能见表10.18。
图10.45 多色成像密集星场二次位置定标工作包流程图
表10.18 多色成像密集星场二次位置定标工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
密集星场二次位置定
标
为初步定标的
WCS 以及前
景星识别工作
包输出的前景
星表
优化以后的高精
度WCS 参数
得到密集星
场中天体的
优化的位置
信息
8.1.4.13 多色成像识别大星系图像工作包
利用在天区表中预先做出的标记，识别受到大星系（≥1´）影
响的探测器。对大星系图像进行处理，扣除背景，同时生成掩码。
遮掩住大星系之后，其他区域的正常天体应按照正常数据处理完成
测光处理。该工作包的输入为仪器效应改正之后的0.5 级数据，输
出为Mask 的图像。多色成像识别大星系图像工作包流程图见图
10.46（工作包编号：KSC-SJ1-PK13），模块列表和功能见表10.19。
图10.46 多色成像识别大星系图像工作包流程图
表10.19 多色成像识别大星系图像工作包模块列表
序号
功能模块名称
输入
输出
实现功能
完成仪器效
应改正的0. 5
级数据
识别大星系
图像
大星系M
ask
图像
（标准）位
置定标
优化的W
CS结
构和head文
件
前景星位置
信息
80
1
识别大星系图像
仪器效应改正
之后的0.5 级
数据
大星系Mask 图
像
得到
Mask
的大星系图
像
8.1.4.14 多色成像识别星云图像工作包
利用在天区表中预先做出的标记，识别受到银河系星云（HII 区、
反射星云、大角直径行星状星云或超新星遗迹等）影响的探测器。
生成相应掩码。遮掩住银河系星云区域之后，其他区域的正常天体
按照正常数据处理完成测光处理。多色成像识别星云图像工作包流
程图见图10.47（工作包编号：KSC-SJ1-PK14），模块列表和功能
见表10.20。
图10.47 多色成像识别星云图像工作包流程图
表10.20 多色成像识别星云图像工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
识别星云图像
仪器效应改正
之后的0.5 级
数据
星云Mask 图像
得到
Mask
的星云图像
8.1.4.15 多色成像星系团建模工作包
利用在天区表中预先做出的标记，识别包含星系团的探测器。
对星系团图像进行处理，扣除成员星系，建立ICL 模型，同时生成
掩码。遮掩住成员星系之后，其他区域的正常天体按照正常数据处
理完成测光处理。多色成像星系团建模工作包流程图见图10.48（工
作包编号：KSC-SJ1-PK15），模块列表和功能见表10.21。
完成仪器效
应改正的0. 5
级数据
识别星云图
像
星云M
ask图
像
81
完成流量定
标的1级数据
星系团成员
星系模型测
光
星系团星系
星表
I CL提取
成员星系
segm
ent at i o
n图
I CL图像
图10.48 多色成像星系团建模工作包流程图
表10.21 多色成像星系团建模工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
星系团成员星系模型
测光
完成流量定标
的1 级星系
团图像数据
星系团成员星系
模型测光数据，
得到星系团
成员星系模
型测光参数
信息
2
ICL 模型建立
星系团成员星
系模型测光数
据
星系团模型参数
信息，ICL 图像
星系团星表，成
员
星
系
segmentation 图
像
完成星系团
建模和星系
团星系星表
8.1.4.16 多色成像识别饱和目标图像工作包
利用在天区表中预先做出的标记，识别包含包和恒星的探测器。
对饱和恒星图像生成掩码。其他区域的正常天体按照正常数据处理
完成测光处理。多色成像识别饱和目标图像工作包流程图见图10.49
（工作包编号：KSC-SJ1-PK16），模块列表和功能见表10.22。
图10.49 多色成像识别饱和目标图像工作包流程图
表10.22 多色成像识别饱和目标图像工作包模块列表
完成仪器效
应改正的0. 5
级数据
识别饱和图
像
饱和M
ask图
像
82
序号
模块名称
输入
输出
实现功能
1
识别饱和图像
仪器效应改正
之后的0.5 级
数据
饱和Mask 图像
得到
Mask
的饱和图像
8.1.4.17 多色成像合并星表提取工作包
该工作包负责在完成单次曝光星表提取后，基于获得的单次曝
光测光星表，对单波段的多次观测进行合并形成单波段合并星表，
最后针对多波段的数据，得到合并的多波段星表并进行多波段恒星、
星系分类。多色成像合并星表提取工作包的流程图见图10.50（工作
包编号：KSC-SJ1-PK-17），模块列表和功能详见表10.23。
单波段星表合
并
单次曝光测
光星表
单波段合并
星表
多波段星表合
并
多波段恒星/
星系分类
多波段合并
星表
图10.50 多色成像合并星表提取工作包流程图
表10.23 多色成像合并星表提取工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
单波段星表合并
单次曝光
测光星表
单波段合并
星表
合并单波段的测光测量
形成更深的单波段合并
星表
2
多波段星表合并
单波段合
并星表
多波段合并
星表
合并多波段的测光信息
3
多波段恒星、星
系分类
多波段合
并星表
目标分类后
的多波段合
并星表
利用多波段的测量信
息，形成多波段的分类
合并星表
8.1.4.18 多色成像2 级数据可用性标记工作包
该工作包面向多色成像2 级科学数据，通过科学验证的方式确
定数据系统的多色成像2 级科学产品在数据指标，精度等方面是否
满足科学家的需求。多色成像2 级数据可用性标记工作包流程图见
图10.51（工作包编号：KSC-SJ9-PK-18），模块列表和功能详见表
10.24。
83
2级天测科学数
据
完整性检查
2级数据可用性标记检查
合理性检查
精度标记
Q
C检查报告及辅
助头文件
数据库
（2级数据）
图10.51 多色成像2 级数据可用性标记工作包流程图
表10.24 多色成像2 级数据可用性标记工作包模块列表
序号
功能模块名称
输入
3 输出
实现功能
1
2 级数数据可用性检
查模块
2 级科学
数据
参数检查报告
保证2 级科学数据能够满足科
学家的需求
8.1.4.19 天区观测覆盖分析工作包
根据预先定义的天区划分表，统计分析每块小天区（brick）的
观测覆盖情况，并将这一数据汇总进数据库。天区观测覆盖分析工
作包流程图见图10.52（工作包编号：KSC-SJ9-PK-19），模块列表
和功能详见表10.25。
预先定义天
区划分表
扫描每个天
区块
在数据库中查找该天区
块覆盖的成像和无缝光
谱观测1级数据
数据库
该天区块满足生成
2级数据产品要求
天区覆盖表
是
否
扫描下一
个天区块
84
图10.52 天区观测覆盖分析工作包流程图
表10.25 天区观测覆盖分析工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
扫描天区模块
预先定义天区
划分表
扫描天区信息
得到天区扫
描信息
2
天区观测覆盖分析
数据库和天区
扫描结果
天区覆盖表
得到天区覆
盖信息
8.1.4.20 多色成像天体分类工作包
根据多色测光或无缝光谱数据判断天体的类型，至少包括：恒
星、星系、QSO、unknown 四类。输入多色测光星表、无缝光谱数
据，输出分类信息以及相应质量标记。多色成像天体分类工作包流
程图见图10.53（工作包编号：KSC-SJ9-PK-20），模块列表和功能
详见表10.26。
图10.53 多色成像天体分类工作包流程图
表10.26 多色成像天体分类工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
天体分类
多波段合并星
表
天体分类信息和
相应的质量标记
得到天体分
类星表
8.1.4.21 多波段PSF 均匀化星表提取工作包
该工作包是星表提取的另一种方案，采用多波段PSF 均匀化的
方法进行星表提取，负责在完成定标后的图像数据和对应的weight、
flag 数据图像进行图像Mosaic 处理、天光背景扣除、天文目标探测、
得到减天光的图像、探测的目标星表后再进行多波段PSF 重构和匹
配，得到PSF 均匀化后的图像数据，在此基础上做全波段联合
deblending 和测光（主要包括改进的Sextracter、改进的A-PHOT、
多波段合并
测光星表
天体分类
天体分类星
表
85
改进的Scarlet、改进的TRACTOR、改进的MusCADeT 几种测光
方法），最终得到整合的全波段联合测光星表。多波段PSF 均匀化
星表提取工作包流程图见图10.54（工作包编号：KSC-SJ1-PK-21），
模块列表和功能详见表10.27。
改进的Sext ract or
改进的A
-PH
OT
改进的Scar l et
改进的TR
ACTOR
改进的M
usCA
DeT
全波段联合debl engdi ng+测光
PSF均匀化后的图像数据
整合的全波段联合测光星表
多波段PSF匹配
多波段PSF重构
定标后的科学图像数
据和对应的weight和
fl ag图像
图像M
osai c处理
M
osai c处后的图像数
据、对应的weight和
fl ag矩阵
天光背景扣除
减天光后的图像、探测的目
标星表
天文目标探测
图10.54 多色成像多波段PSF 均匀化星表提取工作包流程图
表10.27 多色成像多波段PSF 均匀化星表提取工作包模块列表
序号
功能模块名称
输入
输出
实现功能
1
图像Mosaic 处
理
完成定标后的图
像数据、weight
及flag 数据矩
阵
Mosaic 后
的图像数
据
、
weight 及
flag 数据
矩阵
得到Mosaic 后的图
像数据、weight 及
flag 数据矩阵
2
天光背景扣除
完成定标及
Mosaic 后的图像
数据矩阵
减天光后
的图像
天光背景测量及扣除
3
天文目标探测
初步减天光后的
图像数据矩阵
探测的目
标星表
多模式天文目标探测
4
多波段PSF 重构
减天光后的图像
数据矩阵
重构的
PSF
构建PSF 模型，重
构选定位置PSF，通