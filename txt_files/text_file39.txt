学家使用的2 级包括天体三维位置运动等参数及其误差的天体测量
星表和太阳系快速移动天体历表。
对于天体测量而言，针对低密度星场，中等密度星场以及高密
度星场星场图像分别采用不同的目标检测、高精度定心和天体测量
方法进行处理。相关过程数据以及结果数据包括GCRS 及近似
BCRS 下的天球坐标等经质量控制模块检查合格后，生成单帧图像
的1 级天测科学数据。对每一帧图像，查找同一或邻近天区的多历
元观测资料，并依据不同天体的运动规律，使用多历元观测资料检
测图像中的太阳系快速移动天体。检测结果与天测天力星表中的太
37
阳系快速移动天体进行交叉匹配，一旦发现新的天体，经数据质量
控制模块检查合格后，立即发出预警，启动地面后随跟踪。所有检
测到的太阳系快速移动天体经数据质量控制模块检查合格后，生成
包含快速移动目标的时序定位数据及特征信息的1 级天测科学数据。
以1 级天测科学数据为基础，开展单帧图像高精度相对定位工
作，生成单帧图像的2 级天测科学数据。当同一天区或者相邻天区
的单帧图像相对定位数据达到多历元位置数据解算BCRS 下天体测
量5 参数流水线触发标准时，触发该流水线生成天体测量5 参数2
级天测科学数据。当同一太阳系快速移动天体的相对定位数据达到
太阳系快速移动天体轨道确定流水线触发标准时，触发该流水线生
成2 级天测科学数据。当设备正常运行后，需要阶段性对已经完成
定标的1 级和2 级数据进行并合，形成合并后的数据，作为定期科
学数据释放的产品。
8.1.1.2
无缝光谱数据
无缝光谱系统流水线的主要任务是将主巡天无缝光谱12 块探
测器的0 级科学数据（raw data）进行处理生成1 级和2 级科学数
据。无缝光谱数据处理过程简单介绍如下：
无缝光谱数据处理流水线需要使用到参考图像和参数文件，这
些参考数据包括偏置（bias）、不同波长的平场数据（flat）、暗场
（dark），串扰系数（crosstalk）等。这些文件的产生需要在地面测
试阶段提供基础参数，并通过在轨定标数据进行定期更新。大部分
在轨定标的参考数据生成和无缝光谱系统流水线有共用的功能模块，
38
需要通过半手动的方式运行程序并检查，产生合格的参考数据。
经过数据质量控制模块（Data Quality）检查合格后0 级科学数
据基于上述参考数据，经过仪器效应改正转换为未定标的1 级科学
数据（二维光谱科学图像）及其对应的辅助数据。此过程主要目的
是改正光学系统、探测器芯片、电子控制等硬件设备对数据造成的
污染，其中包括的功能较多，且部分功能与探测器选型有关。基本
流程包括：偏置改正、暗场改正、平场改正、快门效应改正、宇宙
线和坏像元探测等。
完成仪器效应改正之后进入光谱抽取和星表制作功能。这个处
理过程复杂且多个功能模块需要交叉迭代。
首先，对未定标的1 级科学数据进行位置定标。此过程分为两
步：第一步，通过18 块多色成像探测器与12 块无缝光谱探测器相
对位置进行初次定标。第二步，结合整个靶面所有探测器进行二次
定标。二次定标需要18 块多色成像探测器共同参与，计算得到整
个靶面的物理位置与天球坐标的投影映射。开始定标计算前，需要
通过数据库获得望远镜指向及其视场大小区域内的外部参考星表，
并从未定标的1 级科学数据中探测得到用于计算的天体的光谱零级
像，最后通过算法获得映射关系的公式。
由于无缝光谱处理需要对应位置的多色成像数据进行辅助，因
此需要基于多色成像数据生成与无缝光谱观测图像相匹配的“伪直
接成像”数据。这个过程包括mosaic 生成，光谱与成像区分别进行
PSF 重构，以及相近波段的PSF 均匀化等一系列操作。
39
完成上述处理过程后，将主要采用两类方法进行光谱抽取，分
别为基于目标源的一维光谱抽取和基于正向建模的一维光谱抽取。
同时对一维光谱进行一系列定标处理，包括，零级像位置精确定标、
光谱追迹定标、波长定标、流量定标、平场数据立方体的构建，孔
径改正等。
最后在经过波长、流量等一系列定标后的一维光谱科学数据基
础上开展目标探测，粗分类，红移测量，典型发射线流量、等值宽
度，天体类型（恒星、星系、类星体、未知天体等）以及相应的误
差的测量。
当设备正常运行后，需要对各类1 级和2 级数据进行整理合并，
形成合并后的数据，作为定期数据释放的产品。主要包括，经过仪
器效应改正后的二维光谱图像、各种参考图像数据、与无缝光谱科
学图像对应的伪直接成像数据、点扩散函数图像网格、经过定标的
一维光谱科学数据、红移星表、发射线星表、天体类型分类星表、
恒星参数星表等。
8.1.2 主要功能
根据空间望远镜数据的特点，以及数据流水线管理的需求，巡
天模块数据的处理流程分为0 级、1 级和2 级数据处理流程。按数
据处理系统初步技术要求，需要实现三方面的主要功能，分别为多
色成像主要功能、天体测量主要功能和无缝光谱主要功能。
8.1.2.1
多色成像主要功能
多色成像0 级数据处理具有2 个功能；1 级数据处理具有7 个
40
主要功能；2 级数据处理具有8 个主要功能，总共实现17 个主要功
能。功能列表和功能详解见表10.2。
表10.2 多色成像主要功能列表
序号
数据
处理
级别
主要功能
功能详解
1
0 级
多色成像0 级数据可
用性标记检查
QC0:检查0 级数据的科学可用性、准
确性
2
0 级
多色成像图像评估
根据多色成像0 级数据图像和外部参
考星表对图像进行评估和分类；同时
为天体测量根据图像恒星数目和参考
星表中恒星数目对图像进行评估和分
类
3
1 级
多色成像仪器效应改
正
利用不同类型的参考图像，改正望远
镜和探测器本身特性所造成的图像数
据不均匀性
4
1 级
目标检测
探测非密集星场图像上的天体
5
1 级
密集星场目标检测
探测密集星场图像上的天体
6
1 级
天体位置定标
利用已定标的星表与望远镜观测科学
图像中探测到的各个天体在探测器上
的中心位置坐标进行交叉匹配，计算
图像的世界坐标框架系统（WCS）
，将
探测器上的位置映射到天球坐标系，
计算中还要考虑各个天体的自行信息
7
1 级
天体流量定标
利用已定标的星表中的星等与空间望
远镜观测科学图像中探测到的对应天
体的流量计数值，计算图像中流量计
数值到星等的转换关系
8
1 级
1 级数据可用性标记
检查（QC1）
QC1:检查1 级数据（包括测光和天测
数据）的科学可用性、准确性
9
1 级
单次曝光星表提取
在已经完成位置与流量定标的单次曝
光科学图像上进行完备的目标探测，
利用探测星表和其他波段观测星表对
目标源进行流量和形态的精确测量等
10
2 级
PSF 重构模型
构建视场的PSF 模型
11
2 级
合并星表
生成合并的星表，包括孔径测光、PSF
测光、星系模型测光等数据
12
2 级
PSF 均匀化星表
对多波段图像采用PSF 均匀化方法测
41
量的星系测光数据
13
2 级
合并图像数据
同一天区、同一滤光片的多次曝光图
像的合并
14
2 级
星系红移
提供高精度星系测光红移参数
15
2 级
天体分类
对天体进行分类，如恒星、星系、QS0
等
16
2 级
强引力透镜源表
搜索强引力透镜源，形成星表
17
2 级
恒星星表
生成恒星星表，包括恒星的自行、大
气参数、距离和消光
8.1.2.2
天体测量主要功能
天体测量1 级数据处理具有5 个主要功能，2 级数据处理具有
3 个主要功能，总共实现8 个主要功能。功能列表和功能详解见表
10.3。
表10.3 天体测量主要功能列表
序号
数据
处理
级别
主要功能
功能详解
1
1 级
坐标系转换
实现ICRS，BCRS，GCRS 等坐标系
的相互转换
2
1 级
高精度定心
计算图像上所有天体的定心量度数据
3
1 级
星表匹配
星场中图像天体与星表天体的匹配
4
1 级
天测相对定位
基于参考星表，根据天体的定心量度
数据获得其GCRS 坐标系下的位置信
息
5
1 级
太阳系快速移动目标
的检测识别
探测图像上太阳系快速移动天体并形
成源表，并对新目标发出预警
6
2 级
高精度单帧图像相对
定位
对单帧图像开展高精度相对定位
7
2 级
高精度天体测量
确定天体的天球位置、三角视差和自
行及对应误差值
8
2 级
太阳系快速移动天体
轨道参数确定
确定太阳系快速移动天体轨道参数并
形成源表
42
8.1.2.3
无缝光谱主要功能
无缝光谱1 级数据处理具有5 个主要功能，2 级数据处理具有
3 个主要功能，总共实现8 个主要功能。功能列表和功能详解见表
10.4。
表10.4 无缝光谱主要功能列表
序号
数据
处理
级别
主要功能
功能详解
1
1 级
无缝光谱0 级数据
可用性标记检查
QC0:保证0 级数据的可用性、准确性
2
1 级
无缝光谱图像评估
根据无缝光谱0 级数据图像和外部参
考星表对图像进行评估和分类
3
1 级
无缝光谱探测器效应
改正
主要负责利用不同类型的参考图像，
改正望远镜和探测器本身特性所造成
的图像数据不均匀性
4
1 级
二维光谱科学数据生
成
完成仪器效应改正，宇宙线去除、畸
变改正、天体测量定位等的单幅图像
及合并二维光谱科学数据（包括Err
和DQ 矩阵）
5
1 级
无缝光谱1 级数据
可用性标记检查1
QC1:保证1 级数据的可用性、准确
性。检测对象是入库的二维光谱科学
数据
6
2 级
一维光谱科学数据生
成
抽取一维光谱，并经过流量和波长定
标得到一维光谱科学数据
7
2 级
无缝光谱1 级数据
可用性标记检查2
保证1 级数据的可用性、准确性，检
测对象是生成的一维光谱科学数据。
8
2 级
无缝光谱星表数据生
成
主要负责星表生成，包括星系分类，
红移测量，天体类型以及恒星星表参
数（恒星大气参数、视向速度、距离
和消光）等。
9
2 级
高精度波长和流量定
标的星表生成
得到高精度波长流量定标的星表
8.1.3 主要流水线
为实现10.1.2 节巡天模块各项功能，根据巡天模块观测设备的
43
数据结构和数据流水线需求，以及输入和输出数据的内容，把整个
巡天模块设备的数据处理流水线设计分为0 级、1 级和2 级处理流
水线，巡天模块整体流水线见图10.3，巡天模块主要流水线列表见
表10.5。
44
Q
C0
图像评估
单幅图像处理流水线
密集星场
处理流水
线
近邻大星
系处理流
水线
星云处理
流水线
   
数据产品生成流水线
（2级处理流水线）
合
并
星
表
流
水
线
PSF
均
匀
化
流
水
线
合
并
图
像
数
据
流
水
线
星
系
红
移
流
水
线
天测高
精度单
帧图像
相对定
位流水
线
强引
力透
镜源
表生
成流
水线
恒星
星表
参数
生成
流水
线
太阳系
快速移
动天体
源表和
轨道参
数生成
流水线
                         图像评估流水线
                         （0级处理流水线）
近邻可分
解星系处
理流水线
低密度单帧图像天体测量初步处理流水线
中等密度单帧图像天体测量初步处理流水线
高密度单帧图像天体测量初步处理流水线
是否存在天区
重复覆盖
是
太阳系快速移动天
体检测识别流水线
天测5
参数
计算
流水
线
星系团处
理流水线
饱和污染
图像处理
流水线
无缝光谱图像
无缝光谱初步处理
流水线
Q
C1
无缝光谱精确
处理流水线
伪直接成像
流水线
星表生成流水线
基于正向建
模的一维光
谱抽取流水
线
基于目标源
的一维光谱
处理流水线
天区观测覆盖分析
Q
C2
数据库
（0级数据）
数据库
（1级数据）
数据库
（2级数据）